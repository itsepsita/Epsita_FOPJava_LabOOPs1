1. cREATE QUERY FOR TABLES


create table Supplier(
SUPP_ID int NOT NULL PRIMARY KEY,
SUPP_NAME varchar(50) NOT NULL,
SUPP_CITY varchar(50) NOT NULL,
SUPP_PHONE varchar(50) NOT NULL
);


create table Customer (
CUS_ID int NOT NULL PRIMARY KEY,
CUS_NAME varchar(20) NOT NULL,
CUS_PHONE varchar(10) NOT NULL,
CUS_CITY varchar(30) NOT NULL,
CUS_GENDER char
);


create table Category(
CAT_ID int NOT NULL PRIMARY KEY,
CAT_NAME varchar(20) NOT NULL
);


create table Product(
PRO_ID int NOT NULL PRIMARY KEY,
PRO_NAME varchar(20) NOT NULL SEFAULT "Dummy",
PRO_DESC varchar(60),
CAT_ID int FOREIGN KEY REFERENCES Category(CAT_ID)
);


create table Supplier_pricing(
PRICING_ID INT NOT NULL PRIMARY KEY,
PRO_ID INT FOREIGN KEY REFERENCES Product(PRO_ID),
SUPP_ID INT FOREIGN KEY REFERENCES Supplier(SUPP_ID),
SUPP_PRICE INT DEFAULT 0
);


CREATE TABLE ORDER(
ORD_ID INT NOT NULL PRIMARY KEY,
ORD_AMOUNT INT NOT NULL,
ORD_DATE INT NOT NULL,
CUS_ID INT FOREIGN KEY REFERENCES Customer(CUS_ID),
PRICING_ID INT FOREIGN KEY REFERENCES SUPPLIER_PRICING(PRICING_ID)
);


CREATE TABLE RATING(
RAT_ID INT PRIMARY KEY,
ORD_ID INT FOREIGN KEY REFERENCES ORDER(ORD_ID),
RAT_RATSTARS INT NOT NULL
);


2. INSERT QUERY FOR TABLES

INSERT INTO SUPPLIER (SUPP_ID, SUPP_NAME, SUPP_CITY, SUPP_PHONE)
VALUES (1, 'Rajesh Retails', 'Delhi', 1234567890);

INSERT INTO SUPPLIER (SUPP_ID, SUPP_NAME, SUPP_CITY, SUPP_PHONE)
VALUES (2,'Appario Ltd.', 'Mumbai', 2589631470);

INSERT INTO SUPPLIER (SUPP_ID, SUPP_NAME, SUPP_CITY, SUPP_PHONE)
VALUES (3, 'Knome products', 'Banglore', 9785462315);

INSERT INTO SUPPLIER (SUPP_ID, SUPP_NAME, SUPP_CITY, SUPP_PHONE)
VALUES (4, 'Bansal Retails', 'Kochi', 8975463285);

INSERT INTO SUPPLIER  (SUPP_ID, SUPP_NAME, SUPP_CITY, SUPP_PHONE)
VALUES (5, 'Mittal Ltd.', 'Lucknow', 7898456532);



INSERT INTO CUSTOMER (CUS_ID, CUS_NAME,CUS_PHONE, CUS_CITY, CUS_GENDER) VALUES (1, 'AAKASH', 9999999999, 'DELHI', 'M');

INSERT INTO CUSTOMER (CUS_ID, CUS_NAME,CUS_PHONE, CUS_CITY, CUS_GENDER) VALUES (2,'AMAN', 9785463215,'NOIDA', 'M');

INSERT INTO CUSTOMER (CUS_ID, CUS_NAME,CUS_PHONE, CUS_CITY, CUS_GENDER) VALUES (3, 'NEHA', 9999999999, 'MUMBAI', 'F');

INSERT INTO CUSTOMER (CUS_ID, CUS_NAME,CUS_PHONE, CUS_CITY, CUS_GENDER) VALUES (4, 'MEGHA', 9994562399, 'KOLKATA', 'F');

INSERT INTO CUSTOMER (CUS_ID, CUS_NAME,CUS_PHONE, CUS_CITY, CUS_GENDER) VALUES (5, 'PULKIT', 7895999999, 'LUCKNOW', 'M');



INSERT INTO CATEGORY (CAT_ID, CAT_NAME) VALUES (1, 'BOOKS');

INSERT INTO CATEGORY (CAT_ID, CAT_NAME) VALUES (2, 'GAMES');

INSERT INTO CATEGORY (CAT_ID, CAT_NAME) VALUES (3, 'GROCERIES');

INSERT INTO CATEGORY (CAT_ID, CAT_NAME) VALUES (4, 'ELECTRONICS');

INSERT INTO CATEGORY (CAT_ID, CAT_NAME) VALUES (5, 'CLOTHES');



INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (1, 'GTA V', 'Windows 7 and above with i5 processor and 8GB RAM', 2);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (2, 'TSHIRT', 'SIZE -L  with Black, Blue and White variations', 5);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (3, 'ROG LAPTOP', 'Windows 10 with 15inch screen, i7 processor, 1TB SSD', 4);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (4, 'OATS', 'Highly Nutritious from Nestle', 3);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (5, 'HARRY POTTER', 'Best Collection of all time by J.K Rowling', 1);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (6, 'MILK', '1L Toned MIlk', 3);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (7, 'Boat Earphones', '1.5Meter long Dolby Atmos', 4);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (8, 'Jeans', 'Stretchable Denim Jeans with various sizes and color', 5);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (9, 'Project IGI', 'compatible with windows 7 and above.', 2);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (10, 'Hoodie', 'Black GUCCI for 13 yrs and above', 5);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (11, 'Rich Dad Poor Dad', 'Written by RObert Kiyosaki' 1);

INSERT INTO PRODUCT (PRO_ID, PRO_NAME, PRO_DESC, CAT_ID) VALUES (12, 'Train Your Brain', 'By Shireen Stephen', 1);



INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (1, 1, 2, 1500);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (2, 3, 5, 30000);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (3, 5, 1, 3000);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (4, 2, 3, 2500);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (5, 4, 1, 1000);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (6, 12, 2, 780);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (7, 12, 4, 789);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (8, 3, 1, 31000);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (9, 1, 5, 1450);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (10, 4, 2, 999);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (11, 7, 3, 549);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (12, 7, 4, 529);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (13, 6, 2, 105);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (14, 6, 1, 99);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (15, 2, 5, 2999);

INSERT INTO SUPPLIER_PRICING (PRICING_ID, PRO_ID, SUPP_ID, SUPP_PRICE) VALUES  (16, 5, 2, 2999);



INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (101, 1500, '2021-10-06', 2, 1);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (102, 1000, '2021-10-12', 3, 5);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (103, 30000, '2021-09-16', 5, 2);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (104, 1500, '2021-10-05', 1, 1);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (105, 3000, '2021-08-16', 4, 3);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (106, 1450, '2021-08-18', 1, 9);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (107, 789, '2021-09-01', 3, 7);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (108, 780, '2021-09-07', 5, 6);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (109, 3000, '2021-00-10', 5, 3);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (110, 2500, '2021-09-10', 2, 4);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (111, 1000, '2021-09-15', 4, 5);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (112, 789, '2021-09-16', 4, 7);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (113, 31000, '2021-09-16', 1, 8);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (114, 1000, '2021-09-16', 3, 5);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (115, 3000, '2021-09-16', 5, 3);

INSERT INTO ORDER (ORD_ID, ORD_AMOUNT, ORD_DATE, CUS_ID, PRICING_ID) VALUES (116, 99, '2021-09-17', 2, 14);



INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (1, 101, 4);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (2, 102, 3);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (3, 103, 1);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (4, 104, 2);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (5, 105, 4);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (6, 106, 3);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (7, 107, 4);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (8, 108, 4);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (9, 109, 3);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (10, 110, 5);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (11, 111, 3);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (12, 112, 4);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (13, 113, 2);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (14, 114, 1);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (15, 115, 1);

INSERT INTO RATING (RAT_ID, ORD_ID, RAT_RATSTARS) VALUES (16, 116, 0);


4). SELECT * FROM CUSTOMER C 
JOIN ORDER O ON C.CUS_ID = O.CUS_ID  
WHERE O.ORD_AMOUNT >= 3000 
ORDER BY GENDER;

5). select or.ord_id, or.ord_amount, or.ord_date, pr.pro_name 
from Order or jOIN Supplier_pricing sp ON or.PRICING_ID = sp.PRICING_ID jOIN Product pr 
on  sp.PRO_ID = pr.PRO_ID  
WHERE or.CUS_ID = 2;


6). SELECT * FROM SUPPLIER 
WHERE sUPP_ID = (SELECT SUPP_ID
FROM SUPPLIER_PRICING 
GROUP BY SUPP_ID 
HAVING COUNT(SUPP_ID) > 1);


7)SELECT C.CAT_ID, C.CAT_NAME, P.PROD_NAME, SP.SUPP_PRICE FROM (SELECT MIN(SUP_PRICE) FROM SUPPLIER_PRICING GROUP BY SUPP_ID) SP JOIN PRODUCT P ON SP.PRO_ID= P.PRO_ID JOIN CATEGORY C ON P.CAT_ID = C.CAT_ID;


8) SELECT PRO_ID, PRO_NAME FROM PRODUCT P JOIN (SELECT * FROM ORDER O JOIN SUPPLIER_PRICING SP ON O.PRICING_ID = SP.PRICING_ID WHERE ORD_DATE > '2021-10-05') SP ON P.PRO_ID= SP.PRO_ID;


9) SELECT CUS_NAME, CUS_GENDER FROM CUSTOMER WHERE CUS_NAME LIKE 'A%' OR '%a';


10) CREATE PROCEDURE SERVICE AS 
BEGIN 
SELECT S.SUPP_ID,S.SUPP_NAME, AVG(R.RAT_RATSTARS), TYPE_OF_SERVICE FROM SUPPLIER S JOIN SUPPLIER_PRICING SP ON S.SUPP_ID=SP.SUPP_ID JOIN (SELECT R.RAT_RATSTARS FROM RATING R JOIN ORDER O ON R.ORD_ID=O.ORD_ID) R 
IF(R.RATSTARS = 5 )
  RETURN "EXCELLENT SERVICE"
ELSE IF(R.RATSTARS>4)
  RETURN "GOOD SERVICE"
ELSE IF(R.RATSTARS > 2)
  RETURN "AVERAGE SERVICE"
ELSE 
  RETURN "POOR SERVICE"
END
